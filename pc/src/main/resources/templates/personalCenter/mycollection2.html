<@override name="title">
我的收藏
</@override>

<@override name="css">
<link href="${contextPath}/css/orstyle.css" rel="stylesheet" type="text/css">
</@override>
<@override name="body">
		<!--头 -->
<b class="line"></b>
		<div class="center">
			<div class="col-main">
				<div class="main-wrap">

					<div class="user-collection">
						<!--标题 -->
									<div class="am-cf am-padding">
										<div class="am-fl am-cf"><strong class="am-text-danger am-text-lg">我的收藏</strong> </div>
									</div>
								<hr/>

								<div class="you-like">
											<div class="s-bar">
												我的收藏
												<a class="am-badge am-btn-warning am-round">降价</a>
												<a class="am-badge am-btn-warning am-round">下架</a>
											</div>
											<!--收藏列表展示-->
											<div class="s-content" id="s-content">

											</div>

									<div onclick="" id="page" class="s-more-btn i-load-more-item" data-screen="0"><i class="am-icon-refresh am-icon-fw"></i>更多</div>
									<!--<div style="display: none;" class="s-more-btn i-load-more-item tt"><p>没有更多数据</p></div>-->
								</div>
						</div>

				</div>
                <!--底部-->
                <#include "/common/includes/include.footer.html"/>
            </div>
            <!--左边菜单-->
            <#include "/personalCenter/common/include.menu.html"/>

		</div>
</@override>
<@override name="js">
<script type="text/javascript">
    //默认加载收藏产品列表
    $(function(){
        console.log("================================1");
        getList(1);
    });

  function getList(favoriteTargetType) {
      var favoriteTargetType=favoriteTargetType;
      var str = {favoriteTargetType:favoriteTargetType,
     	 		page:1,
      			limit:10
      			};
      console.log("================================2"+str.toString());
      //查询产品列表方法
      $.ajax({
          url : "getFavoriteList",
          type : "post",
          data:JSON.stringify(str),
          contentType: 'application/json; charset=UTF-8',
          dataType : "json",
          success : function(data) {
              console.log(data);
              $.each(data.data, function (i, v) {
                  console.log(v);
                  var whatever = liContent(v);
                  $("#s-content").append(whatever);
              });
          }
      });
  }


    function liContent(v) {
        var favoriteId=v.favoriteId;
        var favoriteTargetId=v.favoriteTargetId;
        var favoriteTargetName=v.favoriteTargetName;
        var favoriteTargetType=v.favoriteTargetType;
        var productImage=v.productDto.productImage;
        var specNumber=v.productSpecDto.specNumber;
        var dealNumber=v.productStatisticsDto.dealNumber;
        var content = "";
        var li = $("<div class ='s-item-wrap'>"
            +"<div class='s-item'>"
            +"<div class='s-pic'>"
            +"<a href='#' class='s-pic-link'>"
            +"<img src='"+productImage+"' alt='"+favoriteTargetName+"' title='"+favoriteTargetName+"' class='s-pic-img s-guess-item-img'>"
            +"</a></div>"
            +"<div class='s-info'>"
            +"<div class='s-title' <a href='#' title='favoriteTargetName'>"+favoriteTargetName+"</a></div>"
            +"<div class='s-price-box'>"
            +"<span class='s-price'><em class='s-price-sign'>¥</em><em class='s-value'>"+/*specNumber*/9.9+"</em></span>"
            +"<span class='s-history-price'><em class='s-price-sign'>¥</em><em class='s-value'>68.00</em></span>"
            +"</div><div class='s-extra-box'>"
            +"<span class='s-comment'>好评: 98.03%</span>"
            +"</div></div>"
            +"<div class='s-tp'>"
            +"<span class='ui-btn-loading-before'>找相似</span>"
            +"<i class='am-icon-shopping-cart'></i>"
            +"<span class='ui-btn-loading-before buy'>加入购物车</span>"
            +"<p>"
            +"<a href='javascript:void(0);' onclick='removeFavorite("+favoriteId+")' class='c-nodo J_delFav_btn'>取消收藏</a>"
            +"</p></div></div>"
            +"</div>"
        );
        return li;
    }
    //取消收藏方法
    function removeFavorite(favoriteId){
        $.ajax({
            url : "toRemoveFavorite",
            type : "post",
            data : {
                "favoriteId":favoriteId
            },
            dataType : "json",
            success : function(data) {
                //刷新列表-根据产品/店铺去加载数据
                console.log(data);
                /*if (data.success.equals(true)){
                    //弹框成功
                }*/
            }
        });
    }

    /*  <div class="s-item-wrap">
              <div class="s-item">

              <div class="s-pic">
              <a href="#" class="s-pic-link">
              <img src="../images/0-item_pic.jpg_220x220.jpg" alt="包邮s925纯银项链女吊坠短款锁骨链颈链日韩猫咪银饰简约夏配饰" title="包邮s925纯银项链女吊坠短款锁骨链颈链日韩猫咪银饰简约夏配饰" class="s-pic-img s-guess-item-img">
              </a>
              </div>
              <div class="s-info">
              <div class="s-title"><a href="#" title="包邮s925纯银项链女吊坠短款锁骨链颈链日韩猫咪银饰简约夏配饰">包邮s925纯银项链女吊坠短款锁骨链颈链日韩猫咪银饰简约夏配饰</a></div>
          <div class="s-price-box">
              <span class="s-price"><em class="s-price-sign">¥</em><em class="s-value">42.50</em></span>
          <span class="s-history-price"><em class="s-price-sign">¥</em><em class="s-value">68.00</em></span>
          </div>
          <div class="s-extra-box">
              <span class="s-comment">好评: 98.03%</span>
          <span class="s-sales">月销: 219</span>
          </div>
          </div>
          <div class="s-tp">
              <span class="ui-btn-loading-before">找相似</span>
              <i class="am-icon-shopping-cart"></i>
              <span class="ui-btn-loading-before buy">加入购物车</span>
              <p>
              <a href="javascript:;" class="c-nodo J_delFav_btn">取消收藏</a>
              </p>
              </div>
              </div>
              </div>*/
</script>
</@override>
<@extends name="/common/layout/base.personalCenter.html"/>